{"version":3,"names":["z","Validator","jsonrepair","DEFAULT_STRUCTURED_OUTPUT_PROMPT","zCore","Logger","parseToolCall","message","unparsedToolCalls","match","Error","parsedMessage","JSON","parse","results","tool","name","arguments","push","toolName","e","error","filterObjectKeys","obj","keysToRemove","entries","Object","filteredEntries","filter","key","_","includes","fromEntries","getStructuredOutputPrompt","responseSchema","schemaObject","$ZodType","toJSONSchema","schemaString","stringify","extractBetweenBrackets","text","startIndex","search","openingBracket","closingBracket","slice","indexOf","lastIndexOf","fixAndValidateStructuredOutput","output","extractedOutput","repairedOutput","outputJSON","validator","validate","throwAll"],"sourceRoot":"../../../src","sources":["utils/llm.ts"],"mappings":"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","ignoreList":[]}
